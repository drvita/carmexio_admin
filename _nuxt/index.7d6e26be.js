import A from"./Icon.43ce0162.js";import{_ as B,a as F,b as P,c as D}from"./Bar.a23b54ba.js";import{u as w}from"./useToast.c289a6d2.js";import{A as v}from"./adminsHlp.1ca7c743.js";import{_ as C}from"./_plugin-vue_export-helper.c27b6911.js";import{k as c,l as g,m as n,t as r,z as $,F as y,A as S,B as k,q as l,v as x,C as b,s as f,_ as q}from"./entry.0a49ef2e.js";import{_ as N,a as T,b as z,c as G,d as L}from"./BtnSave.90018629.js";import{_ as V,a as I,b as M}from"./modal.1fa3e18d.js";import"./config.583245fe.js";import"./apiV1.ad2d675e.js";import"./useStorage.fdfc57c0.js";const U={props:{saved:{type:Boolean}},data(){return{data:[],paginate:{},loading:!1,page:1}},methods:{handleClickPage(t){switch(t){case"next":this.page++;break;case"prev":this.page--;break;default:this.page=t}},hanleEdit(t){const o=this.data.find(s=>s.id===t);this.$emit("onEdit",o)},hanleDelete(t){const{toast_success:o,toast_question:s}=w();s(this.$t("Are you sure do this action?"),this.$t("Yes")).then(i=>{if(i.isConfirmed){const a=new v;this.loading=!0,a.delete(t).then(()=>{console.log("[Admin] Admin deleted:",t),o(this.$t("Admin deleted")),this.getAdmins()}).catch(e=>{console.error("[Admin] error put:",(e==null?void 0:e.message)??e),toast_error(this.$t("Sorry, we have error in server, try again later")),this.loading=!1})}})},async getAdmins(){const t=new v,{data:o,meta:s,links:i}=await t.get(null,{page:this.page}).catch(a=>({}));this.data=o??[],this.paginate={...s??{},links:{...i??{}}},this.loading=!1}},watch:{page(){this.getAdmins()},saved(){this.saved&&this.getAdmins()}},mounted(){this.loading=!0,this.getAdmins()}},j={class:"min-w-full divide-y divide-gray-300"},Y={class:"bg-gray-100"},H={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},J={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},K={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},Q={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},R={scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},W={class:"sr-only"},X={key:0},Z={colspan:"5",class:"bg-green-500"},ee={class:"text-center text-base text-white"},te={class:"border-t border-gray-200 py-4 text-center"},ne={class:"border-t border-gray-200"},se={class:"border-t border-gray-200 text-sm text-gray-600"},ae={class:"border-t border-gray-200"},oe={class:"border-t border-gray-200 space-x-2"};function le(t,o,s,i,a,e){const m=A,_=B,u=F,h=P;return c(),g(y,null,[n("table",j,[n("thead",null,[n("tr",Y,[n("th",H,r(t.$t("Id")),1),n("th",J,r(t.$t("Name")),1),n("th",K,r(t.$t("Email")),1),n("th",Q,r(t.$t("Gender")),1),n("th",R,[n("span",W,r(t.$t("Select")),1)])])]),n("tbody",null,[a.loading?(c(),g("tr",X,[n("td",Z,[n("h4",ee,r(t.$t("Loading"))+"...",1)])])):$("",!0),(c(!0),g(y,null,S(a.data,d=>(c(),g("tr",{key:d.id,class:k([a.loading?"opacity-10":"","text-sm"])},[n("td",te," #"+r(d.id),1),n("td",ne,[l(m,{name:"wpf:administrator"}),x(" "+r(d.name),1)]),n("td",se,[l(m,{name:"wpf:message-outline"}),x(" "+r(d.email),1)]),n("td",ae,[l(m,{name:`mdi:gender-${d.gender}`,size:"1.2rem"},null,8,["name"]),x(" "+r(t.$t(d.gender)),1)]),n("td",oe,[l(_,{id:d.id,onOnClick:e.hanleEdit},null,8,["id","onOnClick"]),l(u,{id:d.id,onOnClick:e.hanleDelete},null,8,["id","onOnClick"])])],2))),128))])]),l(h,{meta:a.paginate,onClickPage:e.handleClickPage,onChangePage:e.handleClickPage},null,8,["meta","onClickPage","onChangePage"])],64)}const ie=C(U,[["render",le]]),de={props:{data:{type:Object}},data(){return{form:{id:0,name:"",gender:"",email:""},loading:!1}},methods:{handleFormChange({target:t},o){this.form[o]=t.value},handleBtnSave(){const t=this.validate,{toast_error:o,toast_success:s}=w();if(!t.status){console.error("[Admins] Form inValid"),o(t.message);return}const i=new v,a=this.getModelData();if(this.loading=!0,this.form.id){i.update(this.form.id,a).then(({data:e})=>{e&&(console.log("[Admin] Admin updated:",e.id),s(this.$t("Admin updated")),this.$emit("saved",e.id),this.handleClose()),this.loading=!1}).catch(e=>{console.error("[Admin] error put:",(e==null?void 0:e.message)??e),o(this.$t("Sorry, we have error in server, try again later")),this.loading=!0});return}i.set(a).then(({data:e})=>{e&&(console.log("[Admin] Admin saved:",e.id),s(this.$t("Admin saved")+`. 
 `+this.$t("The password is")+": Password.01#"),this.$emit("saved",e.id),this.handleClose()),this.loading=!1}).catch(e=>{console.error("[Admin] error post:",(e==null?void 0:e.message)??e),o(this.$t("Sorry, we have error in server, try again later")),this.loading=!1})},getModelData(){return{name:this.form.name,gender:this.form.gender,email:this.form.email}},handleClose(){this.$emit("onClose")},setData(){this.data&&(this.form={id:this.data.id,name:this.data.name,gender:this.data.gender,email:this.data.email})}},computed:{dataGender(){const t=[{id:"female",name:this.$t("female")},{id:"male",name:this.$t("male")}];return t.map((o,s)=>{if(o.id===this.form.gender){t[s].selected=!0;return}t[s].selected=!1}),t},title(){return this.form.id?this.$t("Edit admin"):this.$t("New admin")},validate(){var i;const t={...this.form},o=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,s={status:!1,message:""};return((i=t.name)==null?void 0:i.length)<6?(s.message=this.$t("Please, type name with least 6 characters"),s):t.gender?o.test(t.email)?(s.status=!0,s):(s.message=this.$t("Please, type a email valid"),s):(s.message=this.$t("Please, select a gender"),s)},btnDisabled(){return this.loading||!this.validate.status}},mounted(){this.setData()}},re={class:"grid grid-cols-2 gap-4"},me=n("hr",{class:"my-4"},null,-1),ce={class:"grid grid-cols-2 gap-2"};function _e(t,o,s,i,a,e){const m=N,_=T,u=z,h=V,d=I,p=G,E=L,O=M;return c(),b(O,{title:e.title,onOnClose:e.handleClose},{default:f(()=>[n("div",{class:k(a.loading?"opacity-50":"")},[l(h,null,{default:f(()=>[n("div",re,[n("div",null,[l(m,{label:"Name",to:"name",required:!a.form.name},null,8,["required"]),l(_,{defaultText:a.form.name,id:"name",placeholder:"Adolfo Perez",onOnChange:e.handleFormChange},null,8,["defaultText","onOnChange"])]),n("div",null,[l(m,{label:"Gender",to:"gender",required:!a.form.gender},null,8,["required"]),l(u,{data:e.dataGender,id:"gender",onOnChange:e.handleFormChange},null,8,["data","onOnChange"])])])]),_:1}),l(h,null,{default:f(()=>[l(m,{label:"Email",to:"email",required:!a.form.email},null,8,["required"]),l(_,{disabled:a.form.id,defaultText:a.form.email,id:"email",type:"email",placeholder:"myemail@example.org",onOnChange:e.handleFormChange},null,8,["disabled","defaultText","onOnChange"])]),_:1}),me,a.loading?(c(),b(d,{key:0})):$("",!0),n("div",ce,[l(p,{large:"",onOnClick:e.handleClose},null,8,["onOnClick"]),l(E,{disabled:e.btnDisabled,onOnClick:e.handleBtnSave},null,8,["disabled","onOnClick"])])],2)]),_:1},8,["title","onOnClose"])}const he=C(de,[["render",_e]]),ue={data(){return{showForm:!1,saved:!1,dataUser:{}}},methods:{handleEdit(t){this.dataUser=t,this.showForm=!0},handleAdd(){this.showForm=!0}},computed:{saveAdmin(){return!this.showForm&&this.saved}}},ge={class:"px-4 sm:px-6 lg:px-8"},pe={class:"sm:flex sm:items-center"},fe={class:"sm:flex-auto flex text-blue-950"},xe={class:"text-2xl font-semibold leading-6 ml-2"},ve={class:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},ye={class:"-mx-4 mt-10 ring-1 ring-gray-300 sm:mx-0 sm:rounded-lg"};function be(t,o,s,i,a,e){const m=A,_=D,u=ie,h=q,d=he;return c(),g(y,null,[l(h,null,{default:f(()=>[n("div",ge,[n("div",pe,[n("div",fe,[l(m,{name:"wpf:administrator",size:"1.5rem"}),n("h2",xe,r(t.$t("Admins")),1)]),n("div",ve,[l(_,{large:"",onOnClick:e.handleAdd},null,8,["onOnClick"])])]),n("div",ye,[l(u,{saved:e.saveAdmin,onOnEdit:e.handleEdit},null,8,["saved","onOnEdit"])])])]),_:1}),a.showForm?(c(),b(d,{key:0,data:a.dataUser,onOnClose:o[0]||(o[0]=p=>this.showForm=!1),onSaved:o[1]||(o[1]=p=>a.saved=p)},null,8,["data"])):$("",!0)],64)}const Se=C(ue,[["render",be]]);export{Se as default};
