import b from"./Icon.e8dba1b5.js";import{_ as E,a as B,b as P,c as F}from"./Bar.196ccb0d.js";import{u as y}from"./useToast.919b7ffe.js";import{A as S}from"./apiV1.4489ec2e.js";import{_ as v}from"./_plugin-vue_export-helper.c27b6911.js";import{k as m,l as u,m as o,t as c,z as A,F as C,A as D,B as G,q as l,v as x,C as k,s as f,_ as N}from"./entry.1d58e583.js";import{_ as V,a as z,b as L,c as T,d as q}from"./BtnSave.a038a9a7.js";import{_ as I,a as H}from"./modal.89c0830c.js";import"./config.b80ca7b1.js";import"./useStorage.b4f7786c.js";function $(e){let t,a=e[0],i=1;for(;i<e.length;){const n=e[i],s=e[i+1];if(i+=2,(n==="optionalAccess"||n==="optionalCall")&&a==null)return;n==="access"||n==="optionalAccess"?(t=a,a=s(a)):(n==="call"||n==="optionalCall")&&(a=s((...r)=>a.call(t,...r)),t=void 0)}return a}class w extends S{async get(t=0,a={}){return this.method="GET",this.path="admins/list",this.params=a,t===0?this.path="admins":t&&(this.path="admins/"+t),new Promise(async(i,n)=>await this.request().then(s=>{if(s.type==="server error"||$([s,"access",r=>r.response,"optionalAccess",r=>r.errors]))return n(s.response);i(s.response)}))}async set(t){return this.method="POST",this.path="admins",this.params={},this.body=t,t.password||(t.password=this.randString(16)+"#"),new Promise(async(a,i)=>await this.request().then(n=>{if(n.type==="server error"||$([n,"access",s=>s.response,"optionalAccess",s=>s.errors]))return i(n.response);a(n.response)}))}}const M={props:{saved:{type:Boolean}},data(){return{data:[],paginate:{},loading:!1,page:1}},methods:{handleClickPage(e){switch(e){case"next":this.page++;break;case"prev":this.page--;break;default:this.page=e}},hanleEdit(e){console.log("[DEBUG] Handle edit:",e)},hanleDelete(e){const{toast_success:t,toast_question:a}=y();a(this.$t("Are you sure do this action?"),this.$t("Yes")).then(i=>{i.isConfirmed&&(console.log("[DEBUG] Handle delete:",e),t(this.$t("Administrador eliminado: "+e)),this.loading=!0,this.getAdmins())})},async getAdmins(){const e=new w,{data:t,meta:a,links:i}=await e.get(null,{page:this.page});this.data=t??[],this.paginate={...a??{},links:{...i??{}}},this.loading=!1}},watch:{page(){this.getAdmins()},saved(){this.saved&&this.getAdmins()}},mounted(){this.loading=!0,this.getAdmins()}},U={class:"min-w-full divide-y divide-gray-300"},Y={class:"bg-gray-100"},j={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},J={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},K={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},Q={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},R={scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},W={class:"sr-only"},X={key:0},Z={colspan:"5",class:"bg-green-500"},ee={class:"text-center text-base text-white"},te={class:"border-t border-gray-200 py-4 text-center"},ne={class:"border-t border-gray-200"},se={class:"border-t border-gray-200 text-sm text-gray-600"},oe={class:"border-t border-gray-200"},ae={class:"border-t border-gray-200 space-x-2"};function le(e,t,a,i,n,s){const r=b,_=E,p=B,h=P;return m(),u(C,null,[o("table",U,[o("thead",null,[o("tr",Y,[o("th",j,c(e.$t("Id")),1),o("th",J,c(e.$t("Name")),1),o("th",K,c(e.$t("Email")),1),o("th",Q,c(e.$t("Gender")),1),o("th",R,[o("span",W,c(e.$t("Select")),1)])])]),o("tbody",null,[n.loading?(m(),u("tr",X,[o("td",Z,[o("h4",ee,c(e.$t("Loading"))+"...",1)])])):A("",!0),(m(!0),u(C,null,D(n.data,d=>(m(),u("tr",{key:d.id,class:G([n.loading?"opacity-10":"","text-sm"])},[o("td",te," #"+c(d.id),1),o("td",ne,[l(r,{name:"wpf:administrator"}),x(" "+c(d.name),1)]),o("td",se,[l(r,{name:"wpf:message-outline"}),x(" "+c(d.email),1)]),o("td",oe,[l(r,{name:`mdi:gender-${d.gender}`,size:"1.2rem"},null,8,["name"]),x(" "+c(e.$t(d.gender)),1)]),o("td",ae,[l(_,{id:d.id,onOnClick:s.hanleEdit},null,8,["id","onOnClick"]),l(p,{id:d.id,onOnClick:s.hanleDelete},null,8,["id","onOnClick"])])],2))),128))])]),l(h,{meta:n.paginate,onClickPage:s.handleClickPage,onChangePage:s.handleClickPage},null,8,["meta","onClickPage","onChangePage"])],64)}const ie=v(M,[["render",le]]),re={data(){return{form:{id:0,name:"",gender:"",email:""},loading:!1}},methods:{handleFormChange({target:e},t){this.form[t]=e.value},handleBtnSave(){if(!this.formValidation()){console.error("[Cars] Form inValid");return}const e=new w,t=this.getModelData(),{toast_error:a,toast_success:i}=y();e.set(t).then(({data:n})=>{n&&(console.log("[Admin] Admin saved:",n.id),i(this.$t("Admin saved")),this.$emit("saved",n.id),this.handleClose())}).catch(n=>{console.error("[Admin] error:",n==null?void 0:n.message),a(this.$t("Sorry, we have error in server, try again later"))})},getModelData(){return{name:this.form.name,gender:this.form.gender,email:this.form.email}},formValidation(){const{toast_error:e}=y(),t={...this.form};return t.name.length<6?(e(this.$t("Please, type name with least 6 characters")),!1):t.gender?t.email?!0:(e(this.$t("Please, type a email valid")),!1):(e(this.$t("Please, select a gender")),!1)},handleClose(){this.$emit("onClose")}},computed:{dataGender(){const e=[{id:"female",name:this.$t("female")},{id:"male",name:this.$t("male")}];return e.map((t,a)=>{if(t.id===this.form.status){e[a].selected=!0;return}e[a].selected=!1}),e},title(){return this.form.id?this.$t("Edit admin"):this.$t("New admin")}}},de={class:"grid grid-cols-2 gap-4"},ce=o("hr",{class:"my-4"},null,-1),me={class:"grid grid-cols-2 gap-2"};function _e(e,t,a,i,n,s){const r=V,_=z,p=L,h=I,d=T,g=q,O=H;return m(),k(O,{title:s.title,onOnClose:s.handleClose},{default:f(()=>[l(h,null,{default:f(()=>[o("div",de,[o("div",null,[l(r,{label:"Name",to:"name"}),l(_,{id:"name",placeholder:"Adolfo Perez",onOnChange:s.handleFormChange},null,8,["onOnChange"])]),o("div",null,[l(r,{label:"Gender",to:"gender"}),l(p,{data:s.dataGender,id:"gender",onOnChange:s.handleFormChange},null,8,["data","onOnChange"])])])]),_:1}),l(h,null,{default:f(()=>[l(r,{label:"Email",to:"email"}),l(_,{id:"email",type:"email",placeholder:"myemail@example.org",onOnChange:s.handleFormChange},null,8,["onOnChange"])]),_:1}),ce,o("div",me,[l(d,{large:"",onOnClick:s.handleClose},null,8,["onOnClick"]),l(g,{onOnClick:s.handleBtnSave},null,8,["onOnClick"])])]),_:1},8,["title","onOnClose"])}const he=v(re,[["render",_e]]),pe={data(){return{showForm:!1,saved:!1}},methods:{handleAdd(){this.showForm=!0}},computed:{saveAdmin(){return!this.showForm&&this.saved}}},ue={class:"px-4 sm:px-6 lg:px-8"},ge={class:"sm:flex sm:items-center"},fe={class:"sm:flex-auto flex text-blue-950"},xe={class:"text-2xl font-semibold leading-6 ml-2"},ye={class:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},Ce={class:"-mx-4 mt-10 ring-1 ring-gray-300 sm:mx-0 sm:rounded-lg"};function ve(e,t,a,i,n,s){const r=b,_=F,p=ie,h=N,d=he;return m(),u(C,null,[l(h,null,{default:f(()=>[o("div",ue,[o("div",ge,[o("div",fe,[l(r,{name:"wpf:administrator",size:"1.5rem"}),o("h2",xe,c(e.$t("Admins")),1)]),o("div",ye,[l(_,{large:"",onOnClick:s.handleAdd},null,8,["onOnClick"])])]),o("div",Ce,[l(p,{saved:s.saveAdmin},null,8,["saved"])])])]),_:1}),n.showForm?(m(),k(d,{key:0,onOnClose:t[0]||(t[0]=g=>this.showForm=!1),onSaved:t[1]||(t[1]=g=>n.saved=g)})):A("",!0)],64)}const Se=v(pe,[["render",ve]]);export{Se as default};
