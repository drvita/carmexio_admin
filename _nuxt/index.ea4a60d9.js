import S from"./Icon.164a95a5.js";import{_ as P,a as T,b as D,c as M}from"./Bar.1762aab9.js";import{n as $,k as _,l as g,m as s,t as r,z as y,F as C,A as N,v as A,B as O,q as n,C as b,s as m,E as L,_ as U}from"./entry.8372e36e.js";import{u as w}from"./useToast.4d68c65a.js";import{U as x,a as V,_ as z,b as I}from"./brandsHlp.03f30638.js";import{_ as v}from"./_plugin-vue_export-helper.c27b6911.js";import{_ as q,b as Y,a as j,c as G,d as H}from"./BtnSave.5417ea0b.js";import{_ as J,a as K,b as Q}from"./modal.1345364d.js";import{u as R}from"./useStorage.a3b05584.js";import"./config.228008a0.js";import"./apiV1.a915bd3a.js";const W={props:{saved:{type:Boolean}},data(){return{data:[],paginate:{},loading:!1,page:1}},methods:{handleClickPage(e){switch(e){case"next":this.page++;break;case"prev":this.page--;break;default:this.page=e}},hanleEdit(e){$("/dashboard/cars/"+e)},hanleDelete(e){const{toast_success:t,toast_error:i,toast_question:h}=w();h(this.$t("Are you sure do this action?"),this.$t("Yes")).then(d=>{if(d.isConfirmed){const a=new x;this.loading=!0,a.delete(e).then(()=>{console.log("[Car] car deleted:",e),t(this.$t("Car deleted")),this.getCars()}).catch(l=>{console.error("[Car] error:",l==null?void 0:l.message),i(this.$t("Sorry, we have error in server, try again later")),this.loading=!1})}})},async getCars(){const e=new x,{data:t,meta:i,links:h}=await e.get(0,{page:this.page});this.data=t??[],this.paginate={...i??{},links:{...h??{}}},this.loading=!1},clasStatus(e){switch(e){case"for sale":return{"text-green-800":!0};case"saled":return{"text-red-800":!0};default:return{"text-gray-800":!0}}}},watch:{page(){this.getCars()},saved(){this.saved&&this.getCars()}},mounted(){this.loading=!0,this.getCars()}},X={class:"min-w-full divide-y divide-gray-300"},Z={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},ee={scope:"col",class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},te={scope:"col",class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},ae={scope:"col",class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},se={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},ne={scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},oe={class:"sr-only"},le={key:0},re={colspan:"6",class:"bg-green-500"},ie={class:"text-center text-base text-white"},de={class:"border-t border-gray-200 py-2 pl-2 uppercase"},ce={class:"hidden lg:table-cell border-t border-gray-200 lowercase"},he={class:"text-gray-500 text-sm"},me={class:"hidden lg:table-cell border-t border-gray-200 text-sm lowercase"},_e={class:"border-t border-gray-200"},ue={class:"border-t border-gray-200 space-x-2"};function ge(e,t,i,h,d,a){const l=P,u=T,c=D;return _(),g(C,null,[s("table",X,[s("thead",null,[s("tr",null,[s("th",Z,r(e.$t("Brand")),1),s("th",ee,r(e.$t("Model")),1),s("th",te,r(e.$t("Transmition")),1),s("th",ae,r(e.$t("Status")),1),s("th",se,r(e.$t("Price")),1),s("th",ne,[s("span",oe,r(e.$t("Select")),1)])])]),s("tbody",null,[d.loading?(_(),g("tr",le,[s("td",re,[s("h4",ie,r(e.$t("Loading"))+"...",1)])])):y("",!0),(_(!0),g(C,null,N(d.data,o=>(_(),g("tr",{key:o.id},[s("td",de,r(o.brand.name),1),s("td",ce,[A(r(o.model)+" / ",1),s("span",he,r(o.year),1)]),s("td",me,r(e.$t(o.transmition)),1),s("td",{class:O([a.clasStatus(o.status),"hidden lg:table-cell border-t border-gray-200 text-sm capitalize"])},r(e.$t(o.status)),3),s("td",_e," $ "+r(new Intl.NumberFormat().format(o.price_base))+" "+r(o.currency),1),s("td",ue,[n(l,{id:o.id,onOnClick:a.hanleEdit},null,8,["id","onOnClick"]),n(u,{id:o.id,onOnClick:a.hanleDelete},null,8,["id","onOnClick"])])]))),128))])]),n(c,{meta:d.paginate,onClickPage:a.handleClickPage,onChangePage:a.handleClickPage},null,8,["meta","onClickPage","onChangePage"])],64)}const pe=v(W,[["render",ge]]),fe={data(){return{form:{id:0,brand:"",model:"",year:"",transmition:"",status:"for sale",color:"",price:"",currency:"USD",specifications:""},data:[],loading:!1}},methods:{handleFormChange({target:e},t){this.form[t]=e.value},handleBtnSave(){const{toast_error:e,toast_success:t}=w(),i=this.validate;if(!i.status){console.error("[Cars] Form inValid"),e(i.message);return}const h=new x,d=this.getModelData();this.loading=!0,h.set(d).then(({data:a})=>{a&&(console.log("[Car] Car saved:",a.id),t(this.$t("Car saved")),this.$emit("saved",a.id),this.handleClose()),this.loading=!1}).catch(a=>{console.error("[Car] error:",a==null?void 0:a.message),e(this.$t("Sorry, we have error in server, try again later")),this.loading=!1})},getModelData(){const{getUser:e}=R();return{brand_id:this.form.brand,model:this.form.model,year:this.form.year,transmition:this.form.transmition,status:this.form.status,color:this.form.color??"",price_base:this.form.price,currency:this.form.currency,specifications:this.form.specifications&&"--",admin_id:e().id}},handleClose(){this.$emit("onClose")},async getBrands(){const e=new V,{data:t}=await e.get(0,{perpage:200});this.data=t??[]}},computed:{dataBrand(){const e=[...this.data];return e.map(t=>{if(t.id===this.form.brand){t.selected=!0;return}t.selected=!1}),e},dataStatus(){const e=[{id:"for sale",name:this.$t("for sale")},{id:"apart",name:this.$t("apart")},{id:"saled",name:this.$t("saled")}];return e.map((t,i)=>{if(t.id===this.form.status){e[i].selected=!0;return}e[i].selected=!1}),e},dataTransmition(){const e=[{id:"automatic",name:this.$t("automatic")},{id:"standard",name:this.$t("standard")}];return e.map(t=>{if(t.id===this.form.transmition){t.selected=!0;return}t.selected=!1}),e},title(){return this.form.id?this.$t("Edit car"):this.$t("New car")},placeholdColor(){return this.$t("white")},placeholdModel(){return this.$t("classic jetta")},validate(){const e={...this.form},t={status:!1,message:""};return e.brand?e.model?e.year?e.transmition?e.status?e.price?(t.status=!0,t):(t.message=this.$t("Please, type price"),t):(t.message=this.$t("Please, select a status"),t):(t.message=this.$t("Please, select a transmition"),t):(t.message=this.$t("Please, type year"),t):(t.message=this.$t("Please, type model"),t):(t.message=this.$t("Please, select a brand"),t)},btnDisabled(){return this.loading||!this.validate.status}},mounted(){this.getBrands()}},Ce={class:"grid grid-cols-2 gap-4"},be={class:"grid grid-cols-2 gap-4"},xe=s("hr",{class:"my-4"},null,-1),ye={class:"grid grid-cols-2 gap-2"};function ve(e,t,i,h,d,a){const l=q,u=Y,c=J,o=j,f=z,p=I,k=K,F=G,B=H,E=Q;return _(),b(E,{title:a.title,onOnClose:a.handleClose},{default:m(()=>[s("div",{class:O(d.loading?"opacity-50":"")},[n(c,null,{default:m(()=>[n(l,{label:"Brand",to:"brand"}),n(u,{data:a.dataBrand,id:"brand",onOnChange:a.handleFormChange},null,8,["data","onOnChange"])]),_:1}),n(c,null,{default:m(()=>[s("div",Ce,[s("div",null,[n(l,{label:"Model",to:"model"}),n(o,{id:"model",placeholder:a.placeholdModel,onOnChange:a.handleFormChange},null,8,["placeholder","onOnChange"])]),s("div",null,[n(l,{label:"Year",to:"year"}),n(o,{id:"year",placeholder:"2017",onOnChange:a.handleFormChange},null,8,["onOnChange"])])])]),_:1}),n(c,null,{default:m(()=>[n(l,{label:"Transmition",to:"transmition"}),n(u,{data:a.dataTransmition,id:"transmition",onOnChange:a.handleFormChange},null,8,["data","onOnChange"])]),_:1}),n(c,null,{default:m(()=>[s("div",be,[s("div",null,[n(l,{label:"Status",to:"status"}),n(u,{data:a.dataStatus,id:"status",onOnChange:a.handleFormChange},null,8,["data","onOnChange"])]),s("div",null,[n(l,{label:"Color",to:"color",optional:""}),n(o,{id:"color",placeholder:a.placeholdColor,onOnChange:a.handleFormChange},null,8,["placeholder","onOnChange"])])])]),_:1}),n(c,null,{default:m(()=>[n(l,{label:"Price",to:"price"}),n(f,{id:"price",onOnChange:a.handleFormChange,onOnChangeCurrency:a.handleFormChange},null,8,["onOnChange","onOnChangeCurrency"])]),_:1}),n(c,null,{default:m(()=>[n(l,{label:"Specifications",to:"specifications",optional:""}),n(p,{id:"specifications",onOnChange:a.handleFormChange},null,8,["onOnChange"])]),_:1}),xe,d.loading?(_(),b(k,{key:0})):y("",!0),s("div",ye,[n(F,{large:"",onOnClick:a.handleClose},null,8,["onOnClick"]),n(B,{disabled:a.btnDisabled,onOnClick:a.handleBtnSave},null,8,["disabled","onOnClick"])])],2)]),_:1},8,["title","onOnClose"])}const $e=v(fe,[["render",ve]]),Oe={data(){return{showForm:!1,saved:!1}},methods:{handleAdd(){this.showForm=!0}},computed:{saveCar(){return!this.showForm&&this.saved}},watch:{showForm(){this.showForm&&(this.saved=!1)}}},we={class:"px-4 sm:px-6 lg:px-8"},ke={class:"sm:flex sm:items-center"},Fe={class:"sm:flex-auto flex text-indigo-900"},Be={class:"text-2xl font-semibold leading-6 ml-2"},Ee={class:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},Se={class:"-mx-4 mt-10 ring-1 ring-gray-300 sm:mx-0 sm:rounded-lg"};function Pe(e,t,i,h,d,a){const l=S,u=M,c=pe,o=U,f=$e;return _(),g(C,null,[n(o,null,{default:m(()=>[s("div",we,[s("div",ke,[s("div",Fe,[n(l,{name:"wpf:car-rental",size:"1.5rem"}),s("h2",Be,r(e.$t("Cars")),1)]),s("div",Ee,[n(u,{large:"",onOnClick:a.handleAdd},null,8,["onOnClick"])])]),s("div",Se,[n(c,{saved:a.saveCar},null,8,["saved"])])])]),_:1}),d.showForm?(_(),b(f,{key:0,onOnClose:t[0]||(t[0]=p=>this.showForm=!1),onSaved:t[1]||(t[1]=p=>("navigateTo"in e?e.navigateTo:L($))("cars/"+p))})):y("",!0)],64)}const Ye=v(Oe,[["render",Pe]]);export{Ye as default};
