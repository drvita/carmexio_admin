import w from"./Icon.d28f6baf.js";import{_ as E,a as O,b as B,c as F}from"./Bar.9d21a9b5.js";import{u as y}from"./useToast.5e8047f0.js";import{A as v}from"./adminsHlp.140c5e7f.js";import{_ as b}from"./_plugin-vue_export-helper.c27b6911.js";import{k as c,l as g,m as n,t as d,z as $,F as C,A as P,B as S,q as o,v as x,C as A,s as f,_ as D}from"./entry.7e45b807.js";import{_ as N,a as T,b as V,c as z,d as G}from"./BtnSave.0eb93e10.js";import{_ as L,a as I}from"./modal.99115117.js";import"./config.e10c9340.js";import"./apiV1.6105319e.js";import"./useStorage.6e19b9e8.js";const M={props:{saved:{type:Boolean}},data(){return{data:[],paginate:{},loading:!1,page:1}},methods:{handleClickPage(e){switch(e){case"next":this.page++;break;case"prev":this.page--;break;default:this.page=e}},hanleEdit(e){const s=this.data.find(l=>l.id===e);this.$emit("onEdit",s)},hanleDelete(e){const{toast_success:s,toast_question:l}=y();l(this.$t("Are you sure do this action?"),this.$t("Yes")).then(r=>{if(r.isConfirmed){const t=new v;this.loading=!0,t.delete(e).then(()=>{console.log("[Admin] Admin deleted:",e),s(this.$t("Admin deleted")),this.getAdmins()}).catch(a=>{console.error("[Admin] error put:",(a==null?void 0:a.message)??a),toast_error(this.$t("Sorry, we have error in server, try again later")),this.loading=!1})}})},async getAdmins(){const e=new v,{data:s,meta:l,links:r}=await e.get(null,{page:this.page}).catch(t=>({}));this.data=s??[],this.paginate={...l??{},links:{...r??{}}},this.loading=!1}},watch:{page(){this.getAdmins()},saved(){this.saved&&this.getAdmins()}},mounted(){this.loading=!0,this.getAdmins()}},U={class:"min-w-full divide-y divide-gray-300"},q={class:"bg-gray-100"},j={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},Y={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},H={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},J={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 lg:table-cell"},K={scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},Q={class:"sr-only"},R={key:0},W={colspan:"5",class:"bg-green-500"},X={class:"text-center text-base text-white"},Z={class:"border-t border-gray-200 py-4 text-center"},ee={class:"border-t border-gray-200"},te={class:"border-t border-gray-200 text-sm text-gray-600"},ne={class:"border-t border-gray-200"},se={class:"border-t border-gray-200 space-x-2"};function ae(e,s,l,r,t,a){const m=w,h=E,u=O,_=B;return c(),g(C,null,[n("table",U,[n("thead",null,[n("tr",q,[n("th",j,d(e.$t("Id")),1),n("th",Y,d(e.$t("Name")),1),n("th",H,d(e.$t("Email")),1),n("th",J,d(e.$t("Gender")),1),n("th",K,[n("span",Q,d(e.$t("Select")),1)])])]),n("tbody",null,[t.loading?(c(),g("tr",R,[n("td",W,[n("h4",X,d(e.$t("Loading"))+"...",1)])])):$("",!0),(c(!0),g(C,null,P(t.data,i=>(c(),g("tr",{key:i.id,class:S([t.loading?"opacity-10":"","text-sm"])},[n("td",Z," #"+d(i.id),1),n("td",ee,[o(m,{name:"wpf:administrator"}),x(" "+d(i.name),1)]),n("td",te,[o(m,{name:"wpf:message-outline"}),x(" "+d(i.email),1)]),n("td",ne,[o(m,{name:`mdi:gender-${i.gender}`,size:"1.2rem"},null,8,["name"]),x(" "+d(e.$t(i.gender)),1)]),n("td",se,[o(h,{id:i.id,onOnClick:a.hanleEdit},null,8,["id","onOnClick"]),o(u,{id:i.id,onOnClick:a.hanleDelete},null,8,["id","onOnClick"])])],2))),128))])]),o(_,{meta:t.paginate,onClickPage:a.handleClickPage,onChangePage:a.handleClickPage},null,8,["meta","onClickPage","onChangePage"])],64)}const oe=b(M,[["render",ae]]),le={props:{data:{type:Object}},data(){return{form:{id:0,name:"",gender:"",email:""},loading:!1}},methods:{handleFormChange({target:e},s){this.form[s]=e.value},handleBtnSave(){if(!this.formValidation()){console.error("[Admins] Form inValid");return}const e=new v,s=this.getModelData(),{toast_error:l,toast_success:r}=y();if(this.loading=!0,this.form.id){e.update(this.form.id,s).then(({data:t})=>{t&&(console.log("[Admin] Admin updated:",t.id),r(this.$t("Admin updated")),this.$emit("saved",t.id),this.handleClose()),this.loading=!1}).catch(t=>{console.error("[Admin] error put:",(t==null?void 0:t.message)??t),l(this.$t("Sorry, we have error in server, try again later")),this.loading=!0});return}e.set(s).then(({data:t})=>{t&&(console.log("[Admin] Admin saved:",t.id),r(this.$t("Admin saved")+`. 
 `+this.$t("The password is")+": Password.01#"),this.$emit("saved",t.id),this.handleClose()),this.loading=!1}).catch(t=>{console.error("[Admin] error post:",(t==null?void 0:t.message)??t),l(this.$t("Sorry, we have error in server, try again later")),this.loading=!1})},getModelData(){return{name:this.form.name,gender:this.form.gender,email:this.form.email}},formValidation(){const{toast_error:e}=y(),s={...this.form},l=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;return s.name.length<6?(e(this.$t("Please, type name with least 6 characters")),!1):s.gender?l.test(s.email)?!0:(e(this.$t("Please, type a email valid")),!1):(e(this.$t("Please, select a gender")),!1)},handleClose(){this.$emit("onClose")},setData(){this.data&&(this.form={id:this.data.id,name:this.data.name,gender:this.data.gender,email:this.data.email})}},computed:{dataGender(){const e=[{id:"female",name:this.$t("female")},{id:"male",name:this.$t("male")}];return e.map((s,l)=>{if(s.id===this.form.gender){e[l].selected=!0;return}e[l].selected=!1}),e},title(){return this.form.id?this.$t("Edit admin"):this.$t("New admin")}},mounted(){this.setData()}},ie={class:"grid grid-cols-2 gap-4"},de=n("hr",{class:"my-4"},null,-1),re={key:0,class:"w-full text-right py-2 pr-6 border text-primary-800 font-semibold"},me={class:"grid grid-cols-2 gap-2"};function ce(e,s,l,r,t,a){const m=N,h=T,u=V,_=L,i=z,p=G,k=I;return c(),A(k,{title:a.title,onOnClose:a.handleClose},{default:f(()=>[o(_,null,{default:f(()=>[n("div",ie,[n("div",null,[o(m,{label:"Name",to:"name"}),o(h,{defaultText:t.form.name,id:"name",placeholder:"Adolfo Perez",onOnChange:a.handleFormChange},null,8,["defaultText","onOnChange"])]),n("div",null,[o(m,{label:"Gender",to:"gender"}),o(u,{data:a.dataGender,id:"gender",onOnChange:a.handleFormChange},null,8,["data","onOnChange"])])])]),_:1}),o(_,null,{default:f(()=>[o(m,{label:"Email",to:"email"}),o(h,{disabled:t.form.id,defaultText:t.form.email,id:"email",type:"email",placeholder:"myemail@example.org",onOnChange:a.handleFormChange},null,8,["disabled","defaultText","onOnChange"])]),_:1}),de,t.loading?(c(),g("div",re,d(e.$t("Loading"))+"...",1)):$("",!0),n("div",me,[o(i,{large:"",onOnClick:a.handleClose},null,8,["onOnClick"]),o(p,{disabled:t.loading,onOnClick:a.handleBtnSave},null,8,["disabled","onOnClick"])])]),_:1},8,["title","onOnClose"])}const he=b(le,[["render",ce]]),_e={data(){return{showForm:!1,saved:!1,dataUser:{}}},methods:{handleEdit(e){this.dataUser=e,this.showForm=!0},handleAdd(){this.showForm=!0}},computed:{saveAdmin(){return!this.showForm&&this.saved}}},ge={class:"px-4 sm:px-6 lg:px-8"},ue={class:"sm:flex sm:items-center"},pe={class:"sm:flex-auto flex text-blue-950"},fe={class:"text-2xl font-semibold leading-6 ml-2"},xe={class:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},ye={class:"-mx-4 mt-10 ring-1 ring-gray-300 sm:mx-0 sm:rounded-lg"};function ve(e,s,l,r,t,a){const m=w,h=F,u=oe,_=D,i=he;return c(),g(C,null,[o(_,null,{default:f(()=>[n("div",ge,[n("div",ue,[n("div",pe,[o(m,{name:"wpf:administrator",size:"1.5rem"}),n("h2",fe,d(e.$t("Admins")),1)]),n("div",xe,[o(h,{large:"",onOnClick:a.handleAdd},null,8,["onOnClick"])])]),n("div",ye,[o(u,{saved:a.saveAdmin,onOnEdit:a.handleEdit},null,8,["saved","onOnEdit"])])])]),_:1}),t.showForm?(c(),A(i,{key:0,data:t.dataUser,onOnClose:s[0]||(s[0]=p=>this.showForm=!1),onSaved:s[1]||(s[1]=p=>t.saved=p)},null,8,["data"])):$("",!0)],64)}const Se=b(_e,[["render",ve]]);export{Se as default};
